
No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3000

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3001

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3002

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3003

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3004
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...

Starting gRPC server at address :5000...

Starting gRPC server at address :5003...

Starting gRPC server at address :5001...

Starting gRPC server at address :5002...

Starting gRPC server at address :5004...
Starting raft replica server...
Starting raft replica server...
Starting raft replica server...
Starting raft replica server...
Starting raft replica server...

Raft replica server up and listening at port :4002

Raft replica server up and listening at port :4004

Raft replica server up and listening at port :4001

Raft replica server up and listening at port :4003

Raft replica server up and listening at port :4000

Election timer runs out.

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Replica 1 finished ToFollower

Granting vote to 4

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Replica 2 finished ToFollower

Granting vote to 4

Replica 3 finished ToFollower

Granting vote to 4

Replica 0 finished ToFollower

Granting vote to 4

Replica 4 received vote from 2

Replica 4 received vote from 3

Replica 4 transitioning to leader

Transitioning to leader

Add new entry to logs

Add new entry to logs

Add new entry to logs

Add new entry to logs

Transitioned to leader

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

ApplyToStateMachine received commit(s)

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

NO-OP encountered, continuing...

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3000

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3001

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3002

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3003

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3004
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...

Starting gRPC server at address :5004...

Starting gRPC server at address :5001...

Starting gRPC server at address :5002...
Obtaining client stubs of gRPC servers running at peer replicas...

Starting gRPC server at address :5000...

Starting gRPC server at address :5003...
Starting raft replica server...
Starting raft replica server...
Starting raft replica server...
Starting raft replica server...

Raft replica server up and listening at port :4002

Raft replica server up and listening at port :4004

Raft replica server up and listening at port :4001

Raft replica server up and listening at port :4000
Starting raft replica server...

Raft replica server up and listening at port :4003

Election timer runs out.

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Replica 1 finished ToFollower

Granting vote to 0

Replica 4 finished ToFollower

Granting vote to 0

Replica 2 finished ToFollower

Granting vote to 0

Replica 0 received vote from 1

Replica 0 received vote from 4

Replica 0 transitioning to leader

Transitioning to leader

Add new entry to logs

Add new entry to logs

Add new entry to logs

Transitioned to leader

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

In ToFollower, previous state: 0

ApplyToStateMachine received commit(s)

ApplyToStateMachine received commit(s)

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

NO-OP encountered, continuing...

NO-OP encountered, continuing...

Replica 3 finished ToFollower

Add new entry to logs

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...
--- FAIL: TestReElection (15.01s)
    raft_test.go:80: Invalid number of leaders 0, expected 1

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3000

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3001

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3002

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3003

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3004
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...

Starting gRPC server at address :5004...

Starting gRPC server at address :5001...

Starting gRPC server at address :5002...

Starting gRPC server at address :5000...

Starting gRPC server at address :5003...
Starting raft replica server...
Starting raft replica server...
Starting raft replica server...
Starting raft replica server...
Starting raft replica server...

Raft replica server up and listening at port :4004

Raft replica server up and listening at port :4001

Raft replica server up and listening at port :4002

Raft replica server up and listening at port :4003

Raft replica server up and listening at port :4000

Election timer runs out.

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Replica 4 finished ToFollower

Granting vote to 2

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Replica 3 finished ToFollower

Granting vote to 2

Replica 1 finished ToFollower

Granting vote to 2

Replica 2 received vote from 4

Replica 2 received vote from 1

Replica 2 transitioning to leader

Transitioning to leader

Add new entry to logs

Add new entry to logs

Add new entry to logs

Transitioned to leader

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

In ToFollower, previous state: 0

ApplyToStateMachine received commit(s)

ApplyToStateMachine received commit(s)

ApplyToStateMachine received commit(s)

Replica 0 finished ToFollower

Add new entry to logs

NO-OP encountered, continuing...

NO-OP encountered, continuing...

NO-OP encountered, continuing...

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

Election timer runs out.

Received term: 2, My term: 1, My votedFor: 2

Received latestLogIndex: 0, My latestLogIndex: 0, Received latestLogTerm: 1, My latestLogTerm: 1

In ToFollower, previous state: 0

Received term: 2, My term: 1, My votedFor: 2

Received latestLogIndex: 0, My latestLogIndex: 0, Received latestLogTerm: 1, My latestLogTerm: 1

In ToFollower, previous state: 0

Received term: 2, My term: 1, My votedFor: 2

Received latestLogIndex: 0, My latestLogIndex: 0, Received latestLogTerm: 1, My latestLogTerm: 1

In ToFollower, previous state: 0

Replica 1 finished ToFollower

Granting vote to 0

Replica 3 finished ToFollower

Granting vote to 0

Replica 4 finished ToFollower

Granting vote to 0

Replica 0 received vote from 1

Replica 0 received vote from 3

Replica 0 transitioning to leader

Transitioning to leader

Add new entry to logs

Add new entry to logs

Add new entry to logs

Transitioned to leader

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

ApplyToStateMachine received commit(s)

ApplyToStateMachine received commit(s)

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

NO-OP encountered, continuing...

NO-OP encountered, continuing...

Restored Persisted Data:

Restored currentTerm: 1
Restored votedFor: 2
Restored log: [{{{} [] [] <nil>} 0 [] 1 [NO-OP]  }]
Restored log length: 1
Starting local key-value store...

Key-value store up and listening at port :3002
Obtaining client stubs of gRPC servers running at peer replicas...

Starting gRPC server at address :5002...
Starting raft replica server...

Raft replica server up and listening at port :4002

In ToFollower, previous state: 0

Replica 2 finished ToFollower

Add new entry to logs

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3000

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3001

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3002

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3003

No persisted data found.
Starting local key-value store...

Key-value store up and listening at port :3004
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...
Obtaining client stubs of gRPC servers running at peer replicas...

Starting gRPC server at address :5004...

Starting gRPC server at address :5003...

Starting gRPC server at address :5001...

Starting gRPC server at address :5000...

Starting gRPC server at address :5002...
Starting raft replica server...
Starting raft replica server...
Starting raft replica server...
Starting raft replica server...

Raft replica server up and listening at port :4004
Starting raft replica server...

Raft replica server up and listening at port :4001

Raft replica server up and listening at port :4003

Raft replica server up and listening at port :4002

Raft replica server up and listening at port :4000

Election timer runs out.

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Replica 4 finished ToFollower

Granting vote to 0

Replica 3 finished ToFollower

Granting vote to 0

Replica 0 received vote from 4

Replica 0 received vote from 3

Replica 0 transitioning to leader

Transitioning to leader

Add new entry to logs

Add new entry to logs

Transitioned to leader

ApplyToStateMachine received commit(s)

NO-OP encountered, continuing...

Election timer runs out.

Received term: 1, My term: 1, My votedFor: 0

Received latestLogIndex: -1, My latestLogIndex: 0, Received latestLogTerm: -1, My latestLogTerm: 1

Rejecting vote to 2

Received term: 1, My term: 0, My votedFor: -1

Received latestLogIndex: -1, My latestLogIndex: -1, Received latestLogTerm: -1, My latestLogTerm: -1

In ToFollower, previous state: 0

Received term: 1, My term: 1, My votedFor: 0

Received latestLogIndex: -1, My latestLogIndex: 0, Received latestLogTerm: -1, My latestLogTerm: 1

Rejecting vote to 2

Received term: 1, My term: 1, My votedFor: 0

Received latestLogIndex: -1, My latestLogIndex: 0, Received latestLogTerm: -1, My latestLogTerm: 1

Rejecting vote to 2

Replica 1 finished ToFollower

Granting vote to 2

Replica 2 received vote from 1

In ToFollower, previous state: 1

ApplyToStateMachine received commit(s)

ApplyToStateMachine received commit(s)

Replica 2 finished ToFollower

Add new entry to logs

NO-OP encountered, continuing...

NO-OP encountered, continuing...

ApplyToStateMachine received commit(s)
panic: runtime error: index out of range [-1]

goroutine 24801 [running]:
github.com/krithikvaidya/distributed-dns/raft.(*RaftNode).LeaderSendAE(0xc001e39b80, 0xb2df20, 0xc00164b320, 0x2, 0xb26480, 0xc0066b8500, 0xc00603ac00, 0x1)
	/home/krithik/Git/distributed-dns/raft/send_AEs.go:66 +0x7a5
github.com/krithikvaidya/distributed-dns/raft.(*RaftNode).LeaderSendAEs.func1(0xc00603ac00, 0xc001704cc8, 0xc001704ccc, 0xc001e39b80, 0xb26480, 0xc0066b8500, 0x2, 0xc003b5cc00)
	/home/krithik/Git/distributed-dns/raft/send_AEs.go:157 +0x22e
created by github.com/krithikvaidya/distributed-dns/raft.(*RaftNode).LeaderSendAEs
	/home/krithik/Git/distributed-dns/raft/send_AEs.go:131 +0x139
exit status 2
FAIL	github.com/krithikvaidya/distributed-dns/raft	42.671s
